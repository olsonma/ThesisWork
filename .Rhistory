cat("#########################################################################\n")
if (simon==FALSE ) {cat("##  Likelihood Two-Stage Design \n")}
else (cat("##  Simon's Optimal Two-Stage Design (Likelihood display) \n"))
cat("## ---------------------------------------------------------------\n")
cat("##  Hypotheses  : H0: p = ",round(p0,2)," ;  H1: p = ",round(p1,2),"  (OR =",round(or,2),")\n",sep="")
cat("##  Interim     : SS = ",sprintf("%3.0f",round(n.i,1)),"    ;  continue if 1/", round(1/ka.i,2)," < LR < ",round(kb.i,2),"\n",sep="")
cat("##  Final       : SS = ",sprintf("%3.0f",round(n,1)),  "    ;  weak ev  if 1/", round(1/ka,2)," < LR < ",round(kb,2),"\n",sep="")
cat("##  Expected SS : H0:",sprintf("%5.2f",round(ess.0,2)),"  ;  H1:",sprintf("%5.2f",round(ess.1,2)),"\n")
#cat("## ---------------------------------------------------------------\n")
cat("## -------------------------------\n")
cat("##  Interim          H0       H1 \n")
cat("## -------------------------------\n")
cat("##  Continue     ",sprintf("%4.4f",round(pwek.i0,4)), ";",sprintf("%4.4f",round(pwek.i1,4)),"\n")
cat("##  Strong Ev    ",sprintf("%4.4f",round(pstr.i0,4)), ";",sprintf("%4.4f",round(pstr.i1,4)),"\n")
cat("##  Mislead Ev   ",sprintf("%4.4f",round(pmis.i0,4)), ";",sprintf("%4.4f",round(pmis.i1,4)),"\n")
cat("##  LR (Str Ev)   ",sprintf("%4.2f",round(lri.0,4)), "; ",sprintf("%4.2f",round(lri.1,4)),"\n")
cat("##  FDR          ",sprintf("%4.4f",round(fndi.0,4)), ";",sprintf("%4.4f",round(fdri.1,4)),"\n")
cat("## -------------------------------\n")
#cat("## -------------------------------\n")
cat("##  Final            H0       H1 \n")
cat("## -------------------------------\n")
cat("##  Weak Ev      ",sprintf("%4.4f",round(pwek.0,4)), ";",sprintf("%4.4f",round(pwek.1,4)),"\n")
cat("##  Strong Ev    ",sprintf("%4.4f",round(pstr.0,4)), ";",sprintf("%4.4f",round(pstr.1,4)),"\n")
cat("##  Mislead Ev   ",sprintf("%4.4f",round(pmis.0,4)), ";",sprintf("%4.4f",round(pmis.1,4)),"\n")
cat("##  LR (Str Ev)   ",sprintf("%4.2f",round(lrf.0,4)), "; ",sprintf("%4.2f",round(lrf.1,4)),"\n")
cat("##  FDR          ",sprintf("%4.4f",round(fndf.0,4)), ";",sprintf("%4.4f",round(fdrf.1,4)),"\n")
#cat("## -------------------------------\n")
cat("#########################################################################\n")
}
if (output==TRUE) {results}
}
like.2s()
(get=like.2s(output=TRUE))
####
###
##
#
p1=0.60;p0=0.40;n.i=19;n=41;ka.i=(1/4);kb.i=4;ka=(1/4);kb=4;simon=TRUE;r1=8;r=21;output=FALSE
## returns odds ratio
or=(p1*(1-p0))/((p0)*(1-p1))
if (simon==TRUE) {
ka.i=(or^(r1))*((1-p1)/(1-p0))^(n.i)
kb.i=Inf
ka=(or^(r))*((1-p1)/(1-p0))^(n)
kb=Inf
}
#######################################
## LR bounds translated to successes
#######################################
top.i=round((log(kb.i)-n.i*log((1-p1)/(1-p0)))/log(or),10)
bot.i=round((log(ka.i)-n.i*log((1-p1)/(1-p0)))/log(or),10)
top=round((log(kb)-n*log((1-p1)/(1-p0)))/log(or),10)
bot=round((log(ka)-n*log((1-p1)/(1-p0)))/log(or),10)
#print(c(top.i,bot.i,top,bot))
#######################################
## Interim Stage
#######################################
pstr.i0=pbinom(floor(bot.i),size=n.i,prob=p0)
pmis.i0=1-pbinom(floor(top.i),size=n.i,prob=p0)
pwek.i0=(pbinom(floor(top.i),size=n.i,prob=p0)-pbinom(floor(bot.i),size=n.i,prob=p0))
pstr.i1=1-pbinom(floor(top.i),size=n.i,prob=p1)
pmis.i1=pbinom(floor(bot.i),size=n.i,prob=p1)
pwek.i1=(pbinom(floor(top.i),size=n.i,prob=p1)-pbinom(floor(bot.i),size=n.i,prob=p1))
## Expected sample size
ess.0=n.i+(pwek.i0)*(n-n.i)
ess.1=n.i+(pwek.i1)*(n-n.i)
#######################################
## Final Stage
#######################################
## Identify data (successes) that allow continuation (=weak evi at interim stage)
x=floor((bot.i+1)):min(n.i,top.i)
pwek.0=sum(dbinom(x,size=n.i,prob=p0)*(pbinom((top-x),size=(n-n.i),prob=p0)-pbinom((bot-x),size=(n-n.i),prob=p0)))
pstr.0=pstr.i0+sum(dbinom(x,size=n.i,prob=p0)*(pbinom((bot-x),size=(n-n.i),prob=p0)))
pmis.0=pmis.i0+sum(dbinom(x,size=n.i,prob=p0)*(1-pbinom((top-x),size=(n-n.i),prob=p0)))
pwek.1=sum(dbinom(x,size=n.i,prob=p1)*(pbinom((top-x),size=(n-n.i),prob=p1)-pbinom((bot-x),size=(n-n.i),prob=p1)))
pstr.1=pstr.i1+sum(dbinom(x,size=n.i,prob=p1)*(1-pbinom((top-x),size=(n-n.i),prob=p1)))
pmis.1=pmis.i1+sum(dbinom(x,size=n.i,prob=p1)*(pbinom((bot-x),size=(n-n.i),prob=p1)))
## Notice pwek.i0=sum(dbinom(x,size=n.i,prob=p0)) for ease of computation
##################
## Combine results for return (if needed)
##################
inter=rbind(c(1,0,pstr.i0,pmis.i0,pwek.i0,pstr.i0+pmis.i0+pwek.i0,n.i),c(1,1,pstr.i1,pmis.i1,pwek.i1,pstr.i1+pmis.i1+pwek.i1,n.i))
final=rbind(c(2,0,pstr.0,pmis.0,pwek.0,pstr.0+pmis.0+pwek.0,ess.0),c(2,1,pstr.1,pmis.1,pwek.1,pstr.1+pmis.1+pwek.1,ess.1))
results=rbind(inter,final)
dimnames(results)[[2]]=c("Stage","Hyp","Str","Mis","Weak","All","ESS")
##################
## LR and FDR computations
##################
lri.1=results[2,'Str']/results[1,'Mis']
fdri.1=(1+lri.1)^-1
lri.0=results[1,'Str']/results[2,'Mis']
fndi.0=(1+lri.0)^-1
lrf.1=results[4,'Str']/results[3,'Mis']
fdrf.1=(1+lrf.1)^-1
lrf.0=results[3,'Str']/results[4,'Mis']
fndf.0=(1+lrf.0)^-1
lr=c(lri.0,lri.1,lrf.0,lrf.1)
fdr=c(fndi.0,fdri.1,fndf.0,fdrf.1)
results=cbind(results,unname(lr),unname(fdr))
dimnames(results)[[2]]=c("Stage","Hyp","Str","Mis","Weak","All","ESS","LR","FDR")
##################
## Output
##################
if (output==FALSE) {
cat("#########################################################################\n")
if (simon==FALSE ) {cat("##  Likelihood Two-Stage Design \n")}
else (cat("##  Simon's Optimal Two-Stage Design (Likelihood display) \n"))
cat("## ---------------------------------------------------------------\n")
cat("##  Hypotheses  : H0: p = ",round(p0,2)," ;  H1: p = ",round(p1,2),"  (OR =",round(or,2),")\n",sep="")
cat("##  Interim     : SS = ",sprintf("%3.0f",round(n.i,1)),"    ;  continue if 1/", round(1/ka.i,2)," < LR < ",round(kb.i,2),"\n",sep="")
cat("##  Final       : SS = ",sprintf("%3.0f",round(n,1)),  "    ;  weak ev  if 1/", round(1/ka,2)," < LR < ",round(kb,2),"\n",sep="")
cat("##  Expected SS : H0:",sprintf("%5.2f",round(ess.0,2)),"  ;  H1:",sprintf("%5.2f",round(ess.1,2)),"\n")
#cat("## ---------------------------------------------------------------\n")
cat("## -------------------------------\n")
cat("##  Interim          H0       H1 \n")
cat("## -------------------------------\n")
cat("##  Continue     ",sprintf("%4.4f",round(pwek.i0,4)), ";",sprintf("%4.4f",round(pwek.i1,4)),"\n")
cat("##  Strong Ev    ",sprintf("%4.4f",round(pstr.i0,4)), ";",sprintf("%4.4f",round(pstr.i1,4)),"\n")
cat("##  Mislead Ev   ",sprintf("%4.4f",round(pmis.i0,4)), ";",sprintf("%4.4f",round(pmis.i1,4)),"\n")
cat("##  LR (Str Ev)   ",sprintf("%4.2f",round(lri.0,4)), "; ",sprintf("%4.2f",round(lri.1,4)),"\n")
cat("##  FDR          ",sprintf("%4.4f",round(fndi.0,4)), ";",sprintf("%4.4f",round(fdri.1,4)),"\n")
cat("## -------------------------------\n")
#cat("## -------------------------------\n")
cat("##  Final            H0       H1 \n")
cat("## -------------------------------\n")
cat("##  Weak Ev      ",sprintf("%4.4f",round(pwek.0,4)), ";",sprintf("%4.4f",round(pwek.1,4)),"\n")
cat("##  Strong Ev    ",sprintf("%4.4f",round(pstr.0,4)), ";",sprintf("%4.4f",round(pstr.1,4)),"\n")
cat("##  Mislead Ev   ",sprintf("%4.4f",round(pmis.0,4)), ";",sprintf("%4.4f",round(pmis.1,4)),"\n")
cat("##  LR (Str Ev)   ",sprintf("%4.2f",round(lrf.0,4)), "; ",sprintf("%4.2f",round(lrf.1,4)),"\n")
cat("##  FDR          ",sprintf("%4.4f",round(fndf.0,4)), ";",sprintf("%4.4f",round(fdrf.1,4)),"\n")
#cat("## -------------------------------\n")
cat("#########################################################################\n")
}
if (output==TRUE) {results}
source("~/Documents/Vanderbilt/ThesisWork/likelihood 2 stage (v3).R")
source("~/Documents/Vanderbilt/Masters_Thesis/ThesisWork/likelihood 2 stage (v3).R")
source("~/Documents/Vanderbilt/Masters_Thesis/ThesisWork/likelihood 2 stage (v3).R")
p1=0.60;p0=0.40;n.i=19;n=41;ka.i=(1/4);kb.i=4;ka=(1/4);kb=4;simon=TRUE;r1=8;r=21;output=TRUE
## returns odds ratio
or=(p1*(1-p0))/((p0)*(1-p1))
if (simon==TRUE) {
ka.i=(or^(r1))*((1-p1)/(1-p0))^(n.i)
kb.i=Inf
ka=(or^(r))*((1-p1)/(1-p0))^(n)
kb=Inf
}
#######################################
## LR bounds translated to successes
#######################################
top.i=round((log(kb.i)-n.i*log((1-p1)/(1-p0)))/log(or),10)
bot.i=round((log(ka.i)-n.i*log((1-p1)/(1-p0)))/log(or),10)
top=round((log(kb)-n*log((1-p1)/(1-p0)))/log(or),10)
bot=round((log(ka)-n*log((1-p1)/(1-p0)))/log(or),10)
#print(c(top.i,bot.i,top,bot))
#######################################
## Interim Stage
#######################################
pstr.i0=pbinom(floor(bot.i),size=n.i,prob=p0)
pmis.i0=1-pbinom(floor(top.i),size=n.i,prob=p0)
pwek.i0=(pbinom(floor(top.i),size=n.i,prob=p0)-pbinom(floor(bot.i),size=n.i,prob=p0))
pstr.i1=1-pbinom(floor(top.i),size=n.i,prob=p1)
pmis.i1=pbinom(floor(bot.i),size=n.i,prob=p1)
pwek.i1=(pbinom(floor(top.i),size=n.i,prob=p1)-pbinom(floor(bot.i),size=n.i,prob=p1))
## Expected sample size
ess.0=n.i+(pwek.i0)*(n-n.i)
ess.1=n.i+(pwek.i1)*(n-n.i)
#######################################
## Final Stage
#######################################
## Identify data (successes) that allow continuation (=weak evi at interim stage)
x=floor((bot.i+1)):min(n.i,top.i)
pwek.0=sum(dbinom(x,size=n.i,prob=p0)*(pbinom((top-x),size=(n-n.i),prob=p0)-pbinom((bot-x),size=(n-n.i),prob=p0)))
pstr.0=pstr.i0+sum(dbinom(x,size=n.i,prob=p0)*(pbinom((bot-x),size=(n-n.i),prob=p0)))
pmis.0=pmis.i0+sum(dbinom(x,size=n.i,prob=p0)*(1-pbinom((top-x),size=(n-n.i),prob=p0)))
pwek.1=sum(dbinom(x,size=n.i,prob=p1)*(pbinom((top-x),size=(n-n.i),prob=p1)-pbinom((bot-x),size=(n-n.i),prob=p1)))
pstr.1=pstr.i1+sum(dbinom(x,size=n.i,prob=p1)*(1-pbinom((top-x),size=(n-n.i),prob=p1)))
pmis.1=pmis.i1+sum(dbinom(x,size=n.i,prob=p1)*(pbinom((bot-x),size=(n-n.i),prob=p1)))
## Notice pwek.i0=sum(dbinom(x,size=n.i,prob=p0)) for ease of computation
##################
## Combine results for return (if needed)
##################
inter=rbind(c(1,0,pstr.i0,pmis.i0,pwek.i0,pstr.i0+pmis.i0+pwek.i0,n.i),c(1,1,pstr.i1,pmis.i1,pwek.i1,pstr.i1+pmis.i1+pwek.i1,n.i))
final=rbind(c(2,0,pstr.0,pmis.0,pwek.0,pstr.0+pmis.0+pwek.0,ess.0),c(2,1,pstr.1,pmis.1,pwek.1,pstr.1+pmis.1+pwek.1,ess.1))
results=rbind(inter,final)
dimnames(results)[[2]]=c("Stage","Hyp","Str","Mis","Weak","All","ESS")
##################
## LR and FDR computations
##################
lri.1=results[2,'Str']/results[1,'Mis']
fdri.1=(1+lri.1)^-1
lri.0=results[1,'Str']/results[2,'Mis']
fndi.0=(1+lri.0)^-1
lrf.1=results[4,'Str']/results[3,'Mis']
fdrf.1=(1+lrf.1)^-1
lrf.0=results[3,'Str']/results[4,'Mis']
fndf.0=(1+lrf.0)^-1
lr=c(lri.0,lri.1,lrf.0,lrf.1)
fdr=c(fndi.0,fdri.1,fndf.0,fdrf.1)
results=cbind(results,unname(lr),unname(fdr))
dimnames(results)[[2]]=c("Stage","Hyp","Str","Mis","Weak","All","ESS","LR","FDR")
##################
## Output
##################
if (output==FALSE) {
cat("#########################################################################\n")
if (simon==FALSE ) {cat("##  Likelihood Two-Stage Design \n")}
else (cat("##  Simon's Optimal Two-Stage Design (Likelihood display) \n"))
cat("## ---------------------------------------------------------------\n")
cat("##  Hypotheses  : H0: p = ",round(p0,2)," ;  H1: p = ",round(p1,2),"  (OR =",round(or,2),")\n",sep="")
cat("##  Interim     : SS = ",sprintf("%3.0f",round(n.i,1)),"    ;  continue if 1/", round(1/ka.i,2)," < LR < ",round(kb.i,2),"\n",sep="")
cat("##  Final       : SS = ",sprintf("%3.0f",round(n,1)),  "    ;  weak ev  if 1/", round(1/ka,2)," < LR < ",round(kb,2),"\n",sep="")
cat("##  Expected SS : H0:",sprintf("%5.2f",round(ess.0,2)),"  ;  H1:",sprintf("%5.2f",round(ess.1,2)),"\n")
#cat("## ---------------------------------------------------------------\n")
cat("## -------------------------------\n")
cat("##  Interim          H0       H1 \n")
cat("## -------------------------------\n")
cat("##  Continue     ",sprintf("%4.4f",round(pwek.i0,4)), ";",sprintf("%4.4f",round(pwek.i1,4)),"\n")
cat("##  Strong Ev    ",sprintf("%4.4f",round(pstr.i0,4)), ";",sprintf("%4.4f",round(pstr.i1,4)),"\n")
cat("##  Mislead Ev   ",sprintf("%4.4f",round(pmis.i0,4)), ";",sprintf("%4.4f",round(pmis.i1,4)),"\n")
cat("##  LR (Str Ev)   ",sprintf("%4.2f",round(lri.0,4)), "; ",sprintf("%4.2f",round(lri.1,4)),"\n")
cat("##  FDR          ",sprintf("%4.4f",round(fndi.0,4)), ";",sprintf("%4.4f",round(fdri.1,4)),"\n")
cat("## -------------------------------\n")
#cat("## -------------------------------\n")
cat("##  Final            H0       H1 \n")
cat("## -------------------------------\n")
cat("##  Weak Ev      ",sprintf("%4.4f",round(pwek.0,4)), ";",sprintf("%4.4f",round(pwek.1,4)),"\n")
cat("##  Strong Ev    ",sprintf("%4.4f",round(pstr.0,4)), ";",sprintf("%4.4f",round(pstr.1,4)),"\n")
cat("##  Mislead Ev   ",sprintf("%4.4f",round(pmis.0,4)), ";",sprintf("%4.4f",round(pmis.1,4)),"\n")
cat("##  LR (Str Ev)   ",sprintf("%4.2f",round(lrf.0,4)), "; ",sprintf("%4.2f",round(lrf.1,4)),"\n")
cat("##  FDR          ",sprintf("%4.4f",round(fndf.0,4)), ";",sprintf("%4.4f",round(fdrf.1,4)),"\n")
#cat("## -------------------------------\n")
cat("#########################################################################\n")
}
if (output==TRUE) {results}
n1Vec <- NULL
cvVec <- NULL
results
class(results)
results <- as.data.frame(results)
results
results[results$Stage == 1 & results$Hyp == 0]
results[results$Stage == 1 & results$Hyp == 0,]
results[results$Stage == 1 & results$Hyp == 0,]$Str
n1Vec <- NULL
cvVec <- NULL
for(n1 in 15:20){
design <- NULL
counter <- 1
for(cv in 2:15){
results <- like.2s(p1 = 0.4, p0 = 0.2, n.i = n1, n = 37, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 10, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
}
source("~/Documents/Vanderbilt/Masters_Thesis/ThesisWork/likelihood 2 stage (v3).R")
n1Vec <- NULL
cvVec <- NULL
for(n1 in 15:20){
design <- NULL
counter <- 1
for(cv in 2:15){
results <- like.2s(p1 = 0.4, p0 = 0.2, n.i = n1, n = 37, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 10, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
}
design
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 2:15){
results <- like.2s(p1 = 0.4, p0 = 0.2, n.i = n1, n = 37, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 10, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
}
design
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 2:15){
results <- like.2s(p1 = 0.4, p0 = 0.2, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
}
design
## grab the likelihood 2 stage code: Function: like.2s
source("~/Documents/Vanderbilt/Masters_Thesis/ThesisWork/likelihood 2 stage (v3).R")
## arguments:
## p1=0.40,p0=0.20,n.i=17,n=37,ka.i=(1/4),kb.i=4,ka=(1/4),kb=4,simon=FALSE,r1=3,r=10,output=FALSE
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 2:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
}
design
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
}
design
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
planned.PET=64.1
which(abs(results-planned.PET)==min(abs(results-planned.PET)))
}
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
planned.PET=64.1
which(abs(results-planned.PET)>=min(abs(results-planned.PET)))
}
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
planned.PET=64.1
print(which(abs(results-planned.PET)>=min(abs(results-planned.PET))))
}
abs(results-planned.PET)
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
planned.PET=64.1
print(which(abs(design-planned.PET)>=min(abs(design-planned.PET))))
}
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
planned.PET=64.1
print(which(abs(design-planned.PET)==min(abs(design-planned.PET))))
}
planned.PET=64.1
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
planned.PET=0.641
print(which(abs(design-planned.PET)==min(abs(design-planned.PET))))
}
n1Vec <- NULL
cvVec <- NULL
for(n1 in 17:17){
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
## which critical value is closest to PET
planned.PET=0.641
which(abs(design-planned.PET)==min(abs(design-planned.PET)))
}
which(abs(design-planned.PET)==min(abs(design-planned.PET)))
n1Vec <- NULL
cvVec <- NULL
vecCount <- 1
for(n1 in 17:17){
n1Vec[vecCount] <- n1
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
## which critical value is closest to PET
planned.PET=0.641
cvVec[vecCount] <- which(abs(design-planned.PET)==min(abs(design-planned.PET)))
vecCount <- vecCount + 1
}
n1Vec
cvVec
## p1=0.40,p0=0.20,n.i=17,n=37,ka.i=(1/4),kb.i=4,ka=(1/4),kb=4,simon=FALSE,r1=3,r=10,output=FALSE
n1Vec <- NULL
cvVec <- NULL
vecCount <- 1
for(n1 in 17:18){
n1Vec[vecCount] <- n1
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
## which critical value is closest to PET
planned.PET=0.641
cvVec[vecCount] <- which(abs(design-planned.PET)==min(abs(design-planned.PET)))
vecCount <- vecCount + 1
}
n1Vec
cvVec
n1Vec <- NULL
cvVec <- NULL
vecCount <- 1
for(n1 in 17:19){
n1Vec[vecCount] <- n1
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
## which critical value is closest to PET
planned.PET=0.641
cvVec[vecCount] <- which(abs(design-planned.PET)==min(abs(design-planned.PET)))
vecCount <- vecCount + 1
}
n1Ve
n1Vec
cvVec
n1Vec <- NULL
cvVec <- NULL
vecCount <- 1
for(n1 in 16:20){
n1Vec[vecCount] <- n1
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
## which critical value is closest to PET
planned.PET=0.641
cvVec[vecCount] <- which(abs(design-planned.PET)==min(abs(design-planned.PET)))
vecCount <- vecCount + 1
}
n1vec
n1Vec
cvVec
n1Vec <- NULL
cvVec <- NULL
vecCount <- 1
for(n1 in 16:23){
n1Vec[vecCount] <- n1
design <- NULL
counter <- 1
for(cv in 1:15){
results <- like.2s(p1 = 0.6, p0 = 0.4, n.i = n1, n = 41, ka.i = (1/4), kb.i = 4, ka=(1/4), kb = 4, simon = TRUE, r1 = cv, r = 21, output = TRUE)
design[counter] <- results[results$Stage == 1 & results$Hyp == 0,]$Str
counter <- counter+1
}
## which critical value is closest to PET
planned.PET=0.641
cvVec[vecCount] <- which(abs(design-planned.PET)==min(abs(design-planned.PET)))
vecCount <- vecCount + 1
}
n1Vec
cvVec
